{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
  <title>Mini Market</title>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="shortcut icon" type="image/png" href="{% static 'website/images/favicon.png' %}"/>
  <link rel="stylesheet" href="{% static 'website/boots/css/bootstrap.min.css' %}">
  <link rel="stylesheet" href="{% static 'website/boots/css/font-awesome.min.css' %}">
  <!--<link href="https://fonts.googleapis.com/css?family=Roboto" rel="stylesheet">-->
  <script src="{% static 'website/boots/js/jquery-3.2.1.min.js' %}"></script>
  <script src="{% static 'website/boots/js/bootstrap.min.js' %}"></script>

  <!-- Off django -->
  <!--
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
  <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.6.4/angular.min.js"></script>
  -->
  <!-- End Off django -->

  <script src="{% static 'website/boots/js/angular.min.js' %}"></script>
</head>
<body style="font-family: 'Roboto', sans-serif; background-color: #f8f8f8;" ng-app="myApp" ng-controller="myCtrl">
<style>
	.item-image{
		box-shadow: 0 4px 8px 0 rgba(0, 0, 0, 0.2), 0 6px 20px 0 rgba(0, 0, 0, 0.19);
		width: 100px;
		height: 150px;
	}
	.item-image-container{
		box-shadow: 0 4px 8px 0 rgba(0, 0, 0, 0.2), 0 6px 20px 0 rgba(0, 0, 0, 0.19);
		border-radius: 3px;
		text-align: center;
		border: 1px solid #f7f7f7;
		margin-bottom: 15px;
	}
	.item-price{
		padding: 1%;
		border: 1px solid gray;
		text-align: center;
	}
	.item-description{
		padding: 1%;
		border: 1px solid gray;
		text-align: center;
	}
	.item-add-cart{
		width: 100%;
		padding: 1%;
		margin-top: 15px;
		margin-bottom: 100px;
		text-align: center;
	}
	.amount-place-holder{
		width: 100%;
		text-align: center;
		border-radius: 5px;
	}
	.cart-dividers{
		text-align: center;
		width: 70px;
		display: inline-block;
	}
	input[type="number"]::-webkit-outer-spin-button,
	input[type="number"]::-webkit-inner-spin-button {
		-webkit-appearance: none;
		margin: 0;
	}

	input[type="number"] {
		-moz-appearance: textfield;
	}
	.disabled-minus{
		cursor: not-allowed;
	}
	.popup-tables{display: inline-block; padding: 0 2%;}
</style>
	{% if id_user.user_name %}
	<div class="welcome-shopping-block" style="position: fixed; top: 0; right: 0; background-color: #f8f8f8; padding: 0.5% 2%; z-index: 1050; border: 1px solid gray; border-radius: 0 0 0 17px;">WELCOME {% if not creation_status %}BACK{% endif %} {{ id_user.user_name.upper }}</div>
	<script>setTimeout(function(){$('.welcome-shopping-block').slideUp();}, 15000);</script>
	{% endif %}

	<div class="container" style="border: 1px solid darkgray; padding: 1%; margin-top: 2%; margin-bottom: 2%; background-color: white;">
		<div>
			<div class="col-md-3 col-sm-12">
				<div class="item-image-container">
					<img src="{% static 'website/images/tomato-1.jpg' %}" class="item-image">
				</div>
				<div class="col-md-6 col-sm-12 item-description">
					<span>Fresh Tomatoes</span>
				</div>
				<div class="col-md-6 col-sm-12 item-price">
					<span>$5.99</span>
				</div>
				<div class="col-md-12 col-sm-12 item-add-cart">
					<div ng-click="MinusOne(1)" class="item1 cart-dividers btn disabled-minus btn-default">
						<i class="glyphicon glyphicon-minus"></i>
					</div>
					<div class="cart-dividers">
						<input id="bar-code-1" type="number" placeholder="0" min="0" class="amount-place-holder" ng-model="item1" ng-change="Revolver(1)" oninput="this.value = Math.abs(this.value)">
					</div>
					<div ng-click="PlusOne(1)" class="cart-dividers btn btn-info">
						<i class="glyphicon glyphicon-plus"></i>
					</div>
				</div>
			</div>

			<div class="col-md-3 col-sm-12">
				<div class="item-image-container">
					<img src="{% static 'website/images/apple-1.jpg' %}" class="item-image">
				</div>
				<div class="col-md-6 col-sm-12 item-description">
					<span>Fresh Apples</span>
				</div>
				<div class="col-md-6 col-sm-12 item-price">
					<span>$5.99</span>
				</div>
				<div class="col-md-12 col-sm-12 item-add-cart">
					<div ng-click="MinusOne(2)" class="item2 cart-dividers btn disabled-minus btn-default">
						<i class="glyphicon glyphicon-minus"></i>
					</div>
					<div class="cart-dividers">
						<input type="number" placeholder="0" min="0" class="amount-place-holder" ng-model="item2" ng-change="Revolver(2)" oninput="this.value = Math.abs(this.value)">
					</div>
					<div ng-click="PlusOne(2)" class="cart-dividers btn btn-info">
						<i class="glyphicon glyphicon-plus"></i>
					</div>
				</div>
			</div>

			<div class="col-md-3 col-sm-12">
				<div class="item-image-container">
					<img src="{% static 'website/images/pumpkin-1.jpg' %}" class="item-image">
				</div>
				<div class="col-md-6 col-sm-12 item-description">
					<span>Monster Pumpkins</span>
				</div>
				<div class="col-md-6 col-sm-12 item-price">
					<span>$17.99</span>
				</div>
				<div class="col-md-12 col-sm-12 item-add-cart">
					<div ng-click="MinusOne(3)" class="item3 cart-dividers btn disabled-minus btn-default">
						<i class="glyphicon glyphicon-minus"></i>
					</div>
					<div class="cart-dividers">
						<input type="number" placeholder="0" min="0" class="amount-place-holder" ng-model="item3" ng-change="Revolver(3)" oninput="this.value = Math.abs(this.value)">
					</div>
					<div ng-click="PlusOne(3)" class="cart-dividers btn btn-info">
						<i class="glyphicon glyphicon-plus"></i>
					</div>
				</div>
			</div>

			<div class="col-md-3 col-sm-12">
				<div class="item-image-container">
					<img src="{% static 'website/images/tart-1.jpg' %}" class="item-image">
				</div>
				<div class="col-md-6 col-sm-12 item-description">
					<span>Delicious Pataya</span>
				</div>
				<div class="col-md-6 col-sm-12 item-price">
					<span>$35.99</span>
				</div>
				<div class="col-md-12 col-sm-12 item-add-cart">
					<div ng-click="MinusOne(4)" class="item4 cart-dividers btn disabled-minus btn-default">
						<i class="glyphicon glyphicon-minus"></i>
					</div>
					<div class="cart-dividers">
						<input type="number" placeholder="0" min="0" class="amount-place-holder" ng-model="item4" ng-change="Revolver(4)" oninput="this.value = Math.abs(this.value)">
					</div>
					<div ng-click="PlusOne(4)" class="cart-dividers btn btn-info">
						<i class="glyphicon glyphicon-plus"></i>
					</div>
				</div>
			</div>

			<!-------------------------------------------------------->

			<div class="col-md-3 col-sm-12">
				<div class="item-image-container">
					<img src="{% static 'website/images/tomato-1.jpg' %}" class="item-image">
				</div>
				<div class="col-md-6 col-sm-12 item-description">
					<span>French Fries</span>
				</div>
				<div class="col-md-6 col-sm-12 item-price">
					<span>$12.99</span>
				</div>
				<div class="col-md-12 col-sm-12 item-add-cart">
					<div ng-click="MinusOne(5)" class="item5 cart-dividers btn disabled-minus btn-default">
						<i class="glyphicon glyphicon-minus"></i>
					</div>
					<div class="cart-dividers">
						<input type="number" placeholder="0" min="0" class="amount-place-holder" ng-model="item5" ng-change="Revolver(5)" oninput="this.value = Math.abs(this.value)">
					</div>
					<div ng-click="PlusOne(5)" class="cart-dividers btn btn-info">
						<i class="glyphicon glyphicon-plus"></i>
					</div>
				</div>
			</div>

			<div class="col-md-3 col-sm-12">
				<div class="item-image-container">
					<img src="{% static 'website/images/apple-1.jpg' %}" class="item-image">
				</div>
				<div class="col-md-6 col-sm-12 item-description">
					<span>Oriental Salad</span>
				</div>
				<div class="col-md-6 col-sm-12 item-price">
					<span>$16.99</span>
				</div>
				<div class="col-md-12 col-sm-12 item-add-cart">
					<div ng-click="MinusOne(6)" class="item6 cart-dividers btn disabled-minus btn-default">
						<i class="glyphicon glyphicon-minus"></i>
					</div>
					<div class="cart-dividers">
						<input type="number" placeholder="0" min="0" class="amount-place-holder" ng-model="item6" ng-change="Revolver(6)" oninput="this.value = Math.abs(this.value)">
					</div>
					<div ng-click="PlusOne(6)" class="cart-dividers btn btn-info">
						<i class="glyphicon glyphicon-plus"></i>
					</div>
				</div>
			</div>

			<div class="col-md-3 col-sm-12">
				<div class="item-image-container">
					<img src="{% static 'website/images/pumpkin-1.jpg' %}" class="item-image">
				</div>
				<div class="col-md-6 col-sm-12 item-description">
					<span>Blackberries</span>
				</div>
				<div class="col-md-6 col-sm-12 item-price">
					<span>$3.99</span>
				</div>
				<div class="col-md-12 col-sm-12 item-add-cart">
					<div ng-click="MinusOne(7)" class="item7 cart-dividers btn disabled-minus btn-default">
						<i class="glyphicon glyphicon-minus"></i>
					</div>
					<div class="cart-dividers">
						<input type="number" placeholder="0" min="0" class="amount-place-holder" ng-model="item7" ng-change="Revolver(7)" oninput="this.value = Math.abs(this.value)">
					</div>
					<div ng-click="PlusOne(7)" class="cart-dividers btn btn-info">
						<i class="glyphicon glyphicon-plus"></i>
					</div>
				</div>
			</div>

			<div class="col-md-3 col-sm-12">
				<div class="item-image-container">
					<img src="{% static 'website/images/tart-1.jpg' %}" class="item-image">
				</div>
				<div class="col-md-6 col-sm-12 item-description">
					<span>Succulent Tart</span>
				</div>
				<div class="col-md-6 col-sm-12 item-price">
					<span>$35.99</span>
				</div>
				<div class="col-md-12 col-sm-12 item-add-cart">
					<div ng-click="MinusOne(8)" class="item8 cart-dividers btn disabled-minus btn-default">
						<i class="glyphicon glyphicon-minus"></i>
					</div>
					<div class="cart-dividers">
						<input type="number" placeholder="0" min="0" class="amount-place-holder" ng-model="item8" ng-change="Revolver(8)" oninput="this.value = Math.abs(this.value)">
					</div>
					<div ng-click="PlusOne(8)" class="cart-dividers btn btn-info">
						<i class="glyphicon glyphicon-plus"></i>
					</div>
				</div>
			</div>
		</div>
	</div>





	<!-- Modal -->
	<div class="container">
	<!-- Trigger the modal with a button -->
	<div id="cart-floater-container" style="position: fixed; right: 17px; bottom: 0; text-align: right; display: none; z-index: 1050;">
	<input style="width: 70px; cursor: default; text-align: right;" type="text" {% verbatim %}value="${{ (item1 * itemValue1) + (item2 * itemValue2) + (item3 * itemValue4) + (item4 * itemValue4) + (item5 * itemValue5) + (item6 * itemValue6) + (item7 * itemValue7) + (item8 * itemValue8) }}"{% endverbatim %} disabled>
	<button onclick="hideCheckoutForm()" style="border-radius: 100%; outline: none;" type="button" class="btn btn-default btn-lg cart-show-button" data-toggle="modal" data-target="#carter"><i class="glyphicon glyphicon-shopping-cart"></i></button>
	</div>

	<!-- Modal -->
	<div class="modal fade" id="carter" role="dialog">
		<div class="modal-dialog modal-sm">
		<div class="modal-content">
			<div class="modal-header">
			<button type="button" class="close" data-dismiss="modal">&times;</button>
			<h4 class="modal-title" style="text-align: center;"><i style="color: gold;" class="fa fa-shopping-basket"></i> Items in your cart <i style="color: gold;" class="fa fa-shopping-basket"></i></h4>
			</div>
			<div class="modal-body">
			{% verbatim %}
			<div style="text-align: center;"><span style="box-shadow: 0 4px 8px 0 rgba(0, 0, 0, 0.2), 0 6px 20px 0 rgba(0, 0, 0, 0.19); padding: 3%;">Total Amount: <span style="font-weight: bold;">${{ (item1 * itemValue1) + (item2 * itemValue2) + (item3 * itemValue4) + (item4 * itemValue4) + (item5 * itemValue5) + (item6 * itemValue6) + (item7 * itemValue7) + (item8 * itemValue8) }}</span></span></div>
			<hr>
			<!-- Test tables 2 -->
			<div style="text-align: center; box-shadow: 0 4px 8px 0 rgba(0, 0, 0, 0.2), 0 6px 20px 0 rgba(0, 0, 0, 0.19); padding: 3% 0 0 0;">
				<div ng-repeat="test in arrayDescriptions track by $index">
				<div>
				<div class="popup-tables">
				<table>
					<tr>
						<td style="width: 130px;">{{test}}</td>
					</tr>
				</table>
				</div>
				<div class="popup-tables">
				<table>
					<tr>
						<td><input ng-model="Tabler(test)" type="text" style="cursor: default; background-color:white; border: none; width: 45px; text-align: center;" disabled></td>
					</tr>
				</table>
				</div>
				<div class="popup-tables">
				<table>
					<tr>
						<td><button class="btn remove-sign-trigger-{{ TablerIndexer(test) }}" ng-click="NewTriggerRemoveFromCart(test)" style="border: none; background-color: white; padding: 0 10px;"><i class="glyphicon glyphicon-remove-sign" style="color: brown;"></i></button></td>
					</tr>
				</table>
				</div>
				<div>
					<div class="deleting-block-{{ TablerIndexer(test) }}" style="display: none;">
						<p>Do you want to remove this item from your cart?</p>
						<button type="button" ng-click="NewPooper(test)" class="btn btn-danger">Yes</button>
						<button type="button" class="btn btn-info cancel-deleting-block-{{ TablerIndexer(test) }}" ng-click="NewCancelRemoveFromCart(test)">No</button>
					</div>
				</div>
				<br>
				</div>
				</div>
			</div>
			<!-- End Test tables 2 -->
			{% endverbatim %}

			</div>
			<div class="modal-footer" style="text-align: center;">
			<button class="btn btn-danger popup-checkout-button" data-dismiss="modal" onclick="showCheckoutForm()">Checkout <i class="fa fa-credit-card"></i></button>
			<button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
			</div>
		</div>
		</div>
	</div>
	</div>
	<!-- End Modal -->

	<!-- Frame -->
	<div id="market-super-frame-conatiner" class="form-group" style="display: none; position: fixed; right: 1px; bottom: 35px;  border-radius: 3px; padding: 0 2%; background-color: #f7f7f7; box-shadow: 0 4px 8px 0 rgba(0, 0, 0, 0.2), 0 6px 20px 0 rgba(0, 0, 0, 0.19);">
		<div style="width: 100%; text-align: right;"><button type="button" class="close" onclick="hideCheckoutForm()" style="outline: none; color: brown; font-size: 25pt;">&times;</button></div>
		<iframe id="market-super-frame" src="/contact_frame" style="width: 100%; border: 1px solid transparent; height: 32em;">
		</iframe>
	</div>
	<!-- End Frame -->


<!-- Receiving Django Saved Values -->
<script>
	var receivedTotalItems = 0;
	var receivedItemQuantities = [];
	var receivedItemIndexes = [];
	var receivedItemDescriptions = [];

	{% if saved_total_of_items %}
	receivedTotalItems = {{saved_total_of_items}};
	{% endif %}

	{% if saved_quantities_of_items %}
	{% for data in saved_quantities_of_items %}
	receivedItemQuantities.push('{{data}}');
	{% endfor %}
	{% endif %}

	{% if saved_indexes_of_items %}
	{% for data in saved_indexes_of_items %}
	receivedItemIndexes.push('{{data}}');
	{% endfor %}
	{% endif %}

	{% if saved_description_of_items %}
	{% for data in saved_description_of_items %}
	receivedItemDescriptions.push('{{data}}');
	{% endfor %}
	{% endif %}

</script>
<!-- End Receiving Django Saved Values -->

{% verbatim %}
<!-- Angular Important Fields -->
<div style="display: none;">
<input style="width: 100%;" id="total-value-of-items" name="total-value-of-items" type="hidden" value="{{ (item1 * itemValue1) + (item2 * itemValue2) + (item3 * itemValue4) + (item4 * itemValue4) + (item5 * itemValue5) + (item6 * itemValue6) + (item7 * itemValue7) + (item8 * itemValue8) }}">
<input style="width: 100%;" id="items-and-quantities" name="items-and-quantities" type="hidden" value="{{ arrayQuantities }}">
<input style="width: 100%;" id="items-and-indexes" name="items-and-indexes" type="hidden" value="{{ arrayIndexes }}">
<input style="width: 100%;" id="item-descriptions" name="item-descriptions" type="hidden" value="{{ arrayDescriptions }}">
</div>

<script>
/* Prevent negatives in inputs */
function preventNegativa(index){
	var number = document.getElementById(index);
	number.onkeydown = function(e) {
			if(!((e.keyCode > 95 && e.keyCode < 106)
			|| (e.keyCode > 47 && e.keyCode < 58) 
			|| e.keyCode == 8)) {
				return false;
			}
		}
}
/* End negatives */

/* Fill this up with Django */
var products = [
  	{ 
    	name: 'Fresh Tomatoes', 
    	price: 5.99, 
    	quantity: 0,
  	},
  	{ 
    	name: 'Fresh Apples', 
    	price: 5.99, 
    	quantity: 0,
  	},
  	{ 
    	name: 'Monster Pumpkins', 
    	price: 17.99, 
    	quantity: 0,
  	},
  	{ 
    	name: 'Delicious Pataya', 
    	price: 35.99, 
    	quantity: 0,
  	},
  	{ 
    	name: 'French Fries', 
    	price: 12.99, 
    	quantity: 0,
  	}, 
  	{ 
    	name: 'Oriental Salad', 
    	price: 16.99, 
    	quantity: 0,
  	},
	{ 
    	name: 'Blackberries', 
    	price: 3.99, 
    	quantity: 0,
  	},
  	{ 
    	name: 'Succulent Tart', 
    	price: 35.99, 
    	quantity: 0,
  	},
	];
/* End */

/* Trigger Cart popup */
function showCart(){
	//alert(document.getElementById('total-value-of-items').value);
	if(document.getElementById('total-value-of-items').value == '0'){
		$('#cart-floater-container').fadeOut('fast');
		$('.popup-checkout-button').fadeOut(100);
	} else {
		$('#cart-floater-container').fadeIn('fast');
		$('.popup-checkout-button').fadeIn('fast');
	}
}
/* End Trigger Cart popup */

/* Hide Checkout */
function hideCheckoutForm(){
	$('#market-super-frame-conatiner').fadeOut(100);
	$('.cart-show-button').removeClass('btn-danger');
	$('.cart-show-button').addClass('btn-default');
}
/* End Hide Checkout */

/* Slide Checkout */
function slideCheckoutForm(){
	$('#market-super-frame-conatiner').slideUp();
	$('.cart-show-button').removeClass('btn-danger');
	$('.cart-show-button').addClass('btn-default');
}
/* End Hide Checkout */

/* Show Checkout */
function showCheckoutForm(){
	$('#market-super-frame-conatiner').fadeIn(100);
	$('.cart-show-button').removeClass('btn-default');
	$('.cart-show-button').addClass('btn-danger');
}
/* End Show Checkout */

/* Function to trigger ajax click */
function sendToAjax(){
	slideCheckoutForm();
	setTimeout(function(){showCart();}, 500);
	setTimeout(function(){$("#total-value-of-items").trigger("click");}, 1000);
}
/* End Function to trigger ajax click */


var app = angular.module('myApp', []);
app.controller('myCtrl', function($scope) {
	/* Market Scope */
	$scope.item1 = products[0].quantity;
	$scope.itemValue1 = products[0].price;

	$scope.item2 = products[1].quantity;
	$scope.itemValue2 = products[1].price;

	$scope.item3 = products[2].quantity;
	$scope.itemValue3 = products[2].price;

	$scope.item4 = products[3].quantity;
	$scope.itemValue4 = products[3].price;

	$scope.item5 = products[4].quantity;
	$scope.itemValue5 = products[4].price;

	$scope.item6 = products[5].quantity;
	$scope.itemValue6 = products[5].price;

	$scope.item7 = products[6].quantity;
	$scope.itemValue7 = products[6].price;

	$scope.item8 = products[7].quantity;
	$scope.itemValue8 = products[7].price;

	$scope.PlusOne = function(index){
		var item_value = 'item' + index.toString();
		this[item_value] += 1;
		$('.' + item_value).removeClass('disabled-minus btn-default');
		$('.' + item_value).addClass('btn-danger');
		var description = index - 1;
		if($scope.arrayDescriptions.indexOf(products[description].name) != -1){
			/* pop and lock item name */
			var indexRevalued = $scope.arrayDescriptions.indexOf(products[description].name);
			$scope.arrayDescriptions.splice(indexRevalued, 1, products[description].name);

			/* pop and lock item quantity */
			var indexQuantity = $scope.arrayQuantities.indexOf(products[description].name);
			$scope.arrayQuantities.splice(indexQuantity, 2, products[description].name, this[item_value]);

			/* pop and lock scope ids */
			var indexID = $scope.arrayIndexes.indexOf(products[description].name);
			$scope.arrayIndexes.splice(indexID, 2, products[description].name, index);
			
		} else {
			$scope.arrayDescriptions.push(products[description].name);
			$scope.arrayEmbryonic.push(products[description].name);
			$scope.arrayQuantities.push(products[description].name);
			$scope.arrayQuantities.push(this[item_value]);
			$scope.arrayIndexes.push(products[description].name);
			$scope.arrayIndexes.push(index);
		}
		sendToAjax();
	};

	$scope.MinusOne = function(index){
		var item_value = 'item' + index.toString();
		if (this[item_value] != 0){
			this[item_value] -= 1;
			var description = index - 1;

			if($scope.arrayDescriptions.indexOf(products[description].name) != -1){
				/* pop and lower item quantity */
				var indexQuantity = $scope.arrayQuantities.indexOf(products[description].name);
				$scope.arrayQuantities.splice(indexQuantity, 2, products[description].name, this[item_value]);	
			}

			if (this[item_value] == 0){
				$('.' + item_value).removeClass('btn-danger');$('.' + item_value).addClass('disabled-minus btn-default');
				/* pop and blow items */
				var indexRevalued = $scope.arrayDescriptions.indexOf(products[description].name);
				$scope.arrayDescriptions.splice(indexRevalued, 1);
				$scope.arrayEmbryonic.splice(indexRevalued, 1);

				var indexQuantity = $scope.arrayQuantities.indexOf(products[description].name);
				$scope.arrayQuantities.splice(indexQuantity, 2);

				/* blow scope ids */
				var indexID = $scope.arrayIndexes.indexOf(products[description].name);
				$scope.arrayIndexes.splice(indexID, 2);
			}
		} else {
			$('.' + item_value).removeClass('btn-danger');
			$('.' + item_value).addClass('disabled-minus btn-default');
			/* pop and blow items */
			var indexRevalued = $scope.arrayDescriptions.indexOf(products[description].name);
			$scope.arrayDescriptions.splice(indexRevalued, 1);

			var indexQuantity = $scope.arrayQuantities.indexOf(products[description].name);
			$scope.arrayQuantities.splice(indexQuantity, 2);

			/* blow scope ids */
			var indexID = $scope.arrayIndexes.indexOf(products[description].name);
			$scope.arrayIndexes.splice(indexID, 2);
		}
		sendToAjax();
	};

	$scope.Revolver = function(index){
		if(index != null){
			var item_value = 'item' + index.toString();
			var description = index - 1;

			if (this[item_value] != 0){
				$('.' + item_value).removeClass('disabled-minus btn-default');
				$('.' + item_value).addClass('btn-danger');

				if($scope.arrayDescriptions.indexOf(products[description].name) != -1){
					var indexRevalued = $scope.arrayDescriptions.indexOf(products[description].name);
					$scope.arrayDescriptions.splice(indexRevalued, 1, products[description].name);
					var indexQuantity = $scope.arrayQuantities.indexOf(products[description].name);
					$scope.arrayQuantities.splice(indexQuantity, 2, products[description].name, this[item_value]);
					/* pop and lock scope ids */
					var indexID = $scope.arrayIndexes.indexOf(products[description].name);
					$scope.arrayIndexes.splice(indexID, 2, products[description].name, index);	
				} else {
					$scope.arrayDescriptions.push(products[description].name);
					$scope.arrayEmbryonic.push(products[description].name);
					$scope.arrayQuantities.push(products[description].name);
					$scope.arrayQuantities.push(this[item_value]);
					$scope.arrayIndexes.push(products[description].name);
					$scope.arrayIndexes.push(index);
				}

			} else {
				$('.' + item_value).removeClass('btn-danger');
				$('.' + item_value).addClass('disabled-minus btn-default');
				if($scope.arrayDescriptions.indexOf(products[description].name) != -1){
					var indexRevalued = $scope.arrayDescriptions.indexOf(products[description].name);
					$scope.arrayDescriptions.splice(indexRevalued, 1);
					var indexQuantity = $scope.arrayQuantities.indexOf(products[description].name);
					$scope.arrayQuantities.splice(indexQuantity, 2);
					/* blow scope ids */
					var indexID = $scope.arrayIndexes.indexOf(products[description].name);
					$scope.arrayIndexes.splice(indexID, 2);
				}
			}
			sendToAjax();
		}
	};

  function popThemAll(indexer){
	var index = parseInt(indexer);
	switch (index) {
		case 1:
			$scope.item1 = 0;
			break;
		case 2:
			$scope.item2 = 0;
			break;
		case 3:
			$scope.item3 = 0;
			break;
		case 4:
			$scope.item4 = 0;
			break;
		case 5:
			$scope.item5 = 0;
			break;
		case 6:
			$scope.item6 = 0;
			break;
		case  7:
			$scope.item7 = 0;
			break;
		case 8:
			$scope.item8 = 0;
			break;
	}
  }

	$scope.Pooper = function(index){
		if(index != null){
			var item_value = 'item' + index.toString();
			var description = index - 1;

			if($scope.arrayDescriptions.indexOf(products[description].name) != -1){
				var indexRevalued = $scope.arrayDescriptions.indexOf(products[description].name);
				$scope.arrayDescriptions.splice(indexRevalued, 1);
				var indexQuantity = $scope.arrayQuantities.indexOf(products[description].name);
				$scope.arrayQuantities.splice(indexQuantity, 2);
				$('.' + item_value).removeClass('btn-danger');
				$('.' + item_value).addClass('disabled-minus btn-default');
				$(".deleting-block" + index.toString()).fadeOut("fast");
				popThemAll(index);
				sendToAjax();
			}
		}
	};

	/* New Pooper */
	$scope.NewPooper = function(index){
		if(index != null){
			if($scope.arrayIndexes.indexOf(index) != -1){
				var idxRevalued = $scope.arrayIndexes.indexOf(index);
				var enumerator = $scope.arrayIndexes[idxRevalued+1];
				var item_value = 'item' + enumerator.toString();
				var description = enumerator - 1;
				var indexRevalued = $scope.arrayDescriptions.indexOf(products[description].name);
				$scope.arrayDescriptions.splice(indexRevalued, 1);
				var indexQuantity = $scope.arrayQuantities.indexOf(products[description].name);
				$scope.arrayQuantities.splice(indexQuantity, 2);
				$scope.arrayIndexes.splice(idxRevalued, 2);
				$('.' + item_value).removeClass('btn-danger');
				$('.' + item_value).addClass('disabled-minus btn-default');
				$(".deleting-block-" + enumerator.toString()).fadeOut("fast");
				popThemAll(enumerator);
				sendToAjax();
			}
		}
	};

	$scope.TriggerRemoveFromCart = function(index){
		$(".deleting-block" + index.toString()).fadeIn();
		$(".remove-sign-trigger" + index.toString()).fadeOut("fast");
	};

	$scope.CancelRemoveFromCart = function(index){
		$(".deleting-block" + index.toString()).fadeOut("fast");
		$(".remove-sign-trigger" + index.toString()).fadeIn();
	};


	/* Tabler for popup */
	$scope.Tabler = function(index){
		if(index != null){
			if($scope.arrayQuantities.indexOf(index) != -1){
				var qtyRevalued = $scope.arrayQuantities.indexOf(index);
				return $scope.arrayQuantities[qtyRevalued+1];
			}
		}
	};
	/* Tabler for popup */

	/* Tabler Indexer for popup */
	$scope.TablerIndexer = function(index){
		if(index != null){
			if($scope.arrayIndexes.indexOf(index) != -1){
				var idxRevalued = $scope.arrayIndexes.indexOf(index);
				return $scope.arrayIndexes[idxRevalued+1];
			}
		}
	};
	/* End Tabler Indexer for popup */

	/* Tabler trigger */
	$scope.NewTriggerRemoveFromCart = function(index){
		if(index != null){
			if($scope.arrayIndexes.indexOf(index) != -1){
				var qtyRevalued = $scope.arrayIndexes.indexOf(index);
				var enumerator = $scope.arrayIndexes[qtyRevalued+1];
				$(".deleting-block-" + enumerator.toString()).fadeIn();
				$(".remove-sign-trigger-" + enumerator.toString()).fadeOut("fast");
			}
		}
	};
	/* End Tabler trigger */

	$scope.NewCancelRemoveFromCart = function(index){
		if(index != null){
			if($scope.arrayIndexes.indexOf(index) != -1){
				var qtyRevalued = $scope.arrayIndexes.indexOf(index);
				var enumerator = $scope.arrayIndexes[qtyRevalued+1];
				$(".deleting-block-" + enumerator.toString()).fadeOut("fast");
				$(".remove-sign-trigger-" + enumerator.toString()).fadeIn();
			}
		}

	};


	/* Array of product names */
    $scope.arrayDescriptions = receivedItemDescriptions;

	/* Array of product quantities */
    $scope.arrayQuantities = receivedItemQuantities;

	/* Array of product dicts */
    $scope.arrayEmbryonic = [];

	/* Array of scope Indexes */
	$scope.arrayIndexes = receivedItemIndexes;

var stockProducts = [
  	{ 
    	name: 'Fresh Tomatoes',
  	},
  	{ 
    	name: 'Fresh Apples', 
  	},
  	{ 
    	name: 'Monster Pumpkins', 
  	},
  	{ 
    	name: 'Delicious Pataya', 
  	},
  	{ 
    	name: 'French Fries',
  	},
  	{ 
    	name: 'Oriental Salad', 
  	},
  	{ 
    	name: 'Blackberries', 
  	},
  	{ 
    	name: 'Succulent Tart', 
  	},
	];
  function assignThemAll(indexer, qty){	
	var idx = parseInt(indexer);
	switch (idx) {
		case 1:
			$scope.item1 = qty;
			$('.item1').removeClass('disabled-minus btn-default');$('.item1').addClass('btn-danger');
			break;
		case 2:
			$scope.item2 = qty;
			$('.item2').removeClass('disabled-minus btn-default');$('.item2').addClass('btn-danger');
			break;
		case 3:
			$scope.item3 = qty;
			$('.item3').removeClass('disabled-minus btn-default');$('.item3').addClass('btn-danger');
			break;
		case 4:
			$scope.item4 = qty;
			$('.item4').removeClass('disabled-minus btn-default');$('.item4').addClass('btn-danger');
			break;
		case 5:
			$scope.item5 = qty;
			$('.item5').removeClass('disabled-minus btn-default');$('.item5').addClass('btn-danger');
			break;
		case 6:
			$scope.item6 = qty;
			$('.item6').removeClass('disabled-minus btn-default');$('.item6').addClass('btn-danger');
			break;
		case  7:
			$scope.item7 = qty;
			$('.item7').removeClass('disabled-minus btn-default');$('.item7').addClass('btn-danger');
			break;
		case 8:
			$scope.item8 = qty;
			$('.item8').removeClass('disabled-minus btn-default');$('.item8').addClass('btn-danger');
			break;
	}
	
  }

for (var i = 0; i < stockProducts.length; i++) {	
	if($scope.arrayIndexes.indexOf(products[i].name) != -1){
		var foundPosition = $scope.arrayIndexes.indexOf(products[i].name);
		var foundIndex = $scope.arrayIndexes[foundPosition + 1];
		var foundQuantity = parseInt($scope.arrayQuantities[foundPosition + 1]);
		assignThemAll(foundIndex, foundQuantity);
	}
}

setTimeout(function(){showCart();}, 500);

});
</script>
<!-- End Test -->
{% endverbatim %}

<!--
	<br>
<footer class="avenirRegular" style="background-color: black; clear: both; color: white; padding: 1%; text-align: center;">
	<h4>Copyright Â© 2018 Mini Market, All rights reserved.</h4>
</footer>
-->




<script>
$("#total-value-of-items").click(function(){
	var totalOfItems = document.getElementById('total-value-of-items').value;
	var quantitiesOfItems = document.getElementById('items-and-quantities').value;
	var indexesOfItems = document.getElementById('items-and-indexes').value;
	var descriptionOfItems = document.getElementById('item-descriptions').value;

	$.ajax({
	url: '/ajax/totalizer/',
	data: {
		'totalOfItems': totalOfItems,
		'quantitiesOfItems': quantitiesOfItems,
		'indexesOfItems': indexesOfItems,
		'descriptionOfItems': descriptionOfItems
	},
	dataType: 'json',
	success: function (data) {
		if (data.is_taken) {
		//alert("A user with this username already exists.");
		}
	}
	});

});
</script>

<!-- Frame close script -->
<script>
window.addEventListener('message', receiveMessage, false);
function receiveMessage(evt){
	//document.getElementById('market-super-frame-conatiner').style.display = "none";
	$('#market-super-frame-conatiner').fadeOut(1000);
	//location.reload();
	window.location = "{% url 'website:sheet' %}";
}
</script>
<!-- End frame close -->

</body>
</html>